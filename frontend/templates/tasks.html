{% extends "base.html" %}
{% block title %}Tasks · Pomoweb{% endblock %}
{% block content %}
<div class="max-w-2xl mx-auto">
  <div class="flex items-center justify-between mb-4">
    <h2 class="text-xl font-semibold">Your Tasks</h2>
    <a href="{{ url_for('home') }}" class="link">← Back to timer</a>
  </div>

  <div class="glass-card rounded-2xl p-6 shadow-soft">
    <form method="POST" class="flex gap-3 mb-6">
      <input type="text" name="description" placeholder="New task" class="input flex-1" required>
      <button type="submit" class="btn-primary">Add</button>
    </form>

    {% if tasks %}
      <ul class="space-y-3">
        {% for task in tasks %}
          <li class="flex items-center justify-between bg-white/70 border border-slate-200 rounded-xl p-3">
            <div class="flex items-center gap-3">
              <form method="POST" action="{{ url_for('toggle_task', task_id=task.id) }}">
                <button type="submit" class="h-5 w-5 rounded-full border border-slate-300 flex items-center justify-center">
                  {% if task.completed %}
                    <span class="h-3 w-3 rounded-full bg-accent-500 inline-block"></span>
                  {% endif %}
                </button>
              </form>
              <span class="{% if task.completed %}line-through text-slate-400{% endif %}">{{ task.description }}</span>
            </div>

            <!-- Delete button with confirmation dialog -->
            <form method="POST" action="{{ url_for('delete_task', task_id=task.id) }}" onsubmit="return confirm('Are you sure you want to delete this task?');">
              <!-- Include CSRF token if you're using Flask-WTF for CSRF protection -->
              {% if csrf_token %}
                <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
              {% endif %}
              <button class="text-slate-500 hover:text-red-600" title="Delete">Delete</button>
            </form>
          </li>
        {% endfor %}
      </ul>
    {% else %}
      <p class="text-slate-500">No tasks yet. Add your first one above.</p>
    {% endif %}
  </div>
</div>
{% endblock %}
